/* frontend/style.css */
:root {
    --table-green: #006400; /* 深绿色 */
    --felt-green: #004d00; /* 更深的毛毡绿 */
    --light-gray-bg: #f0f0f0;
    --card-width: 58px; /* 统一控制牌宽 */
    --card-height: 82px; /* 统一控制牌高 */
    --card-border-radius: 4px;
    --text-on-dark: #f0f0f0;
    --highlight-yellow: #ffdd57;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--light-gray-bg); /* 全局背景浅灰色 */
    color: #333;
    display: flex;
    flex-direction: column;
    height: 100vh; /* 使用 100vh 来撑满视口 */
    overflow: hidden; /* 防止不必要的滚动条 */
}

header {
    background-color: #333; /* 深色header */
    color: white;
    padding: 0.6em 0;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    flex-shrink: 0; /* 防止header被压缩 */
    z-index: 10;
}

main {
    flex-grow: 1; /* 占据剩余所有垂直空间 */
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 10px; /* 给牌桌周围一点边距 */
    box-sizing: border-box;
    overflow: hidden; /* main内部也防止滚动 */
}

#game-table {
    background-color: var(--table-green);
    width: 100%; /* 牌桌宽度充满main */
    height: 100%; /* 牌桌高度充满main */
    max-width: 1200px; /* 限制最大宽度 */
    max-height: 90vh; /* 限制最大高度，给header/footer留空间 */
    margin: auto;
    padding: 15px;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    display: flex; /* 改为 flex 布局，垂直排列 */
    flex-direction: column;
    justify-content: space-between; /* 上中下三行尽可能分开 */
    gap: 10px;
    position: relative;
    box-sizing: border-box;
}

/* --- 玩家区域和布局 --- */
.player-area {
    background-color: rgba(0, 0, 0, 0.2);
    padding: 8px;
    border-radius: 8px;
    display: flex;
    flex-direction: column; /* 默认垂直排列 info, played, hand */
    align-items: center;
    color: var(--text-on-dark);
    box-sizing: border-box;
    min-width: 150px; /* 防止区域过窄 */
}

#player-top-area {
    width: 60%;
    max-width: 450px;
    align-self: center; /* 顶部玩家在牌桌内水平居中 */
}
#player-top-area .player-info { order: -1; } /* 信息在牌上方 */
#player-top-area .played-cards-area { order: 0; }
#player-top-area .hand { order: 1; }


#middle-row {
    display: flex;
    justify-content: space-between; /* 左、中、右元素分开 */
    align-items: center; /* 垂直居中对齐 */
    width: 100%;
    gap: 10px;
    flex-grow: 1; /* 中间行占据可用空间 */
    min-height: 120px; /* 保证中间行有一定高度 */
}

.side-opponent { /* 应用于左右两边的对手 */
    flex-basis: 20%; /* 占据一定基础宽度 */
    max-width: 180px;
    height: 100%; /* 尝试撑满中间行高度 */
    justify-content: center; /* 垂直内容居中 */
}
.side-opponent .hand { flex-grow: 1; width: 100%; }
.side-opponent .player-info { order: -1; }

#center-table-elements {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center; /* 垂直居中底牌和信息 */
    gap: 15px;
    flex-grow: 1; /* 中间的底牌/信息区占据主要空间 */
}

#landlord-cards-area {
    background-color: rgba(0,0,0,0.35);
    padding: 8px;
    border-radius: 5px;
    text-align: center;
}
#landlord-cards-area h2 {
    margin: 0 0 5px 0;
    font-size: 0.9em;
    color: var(--highlight-yellow);
}

#game-info-area {
    padding: 8px;
    background-color: rgba(0,0,0,0.25);
    border-radius: 5px;
    text-align: center;
    min-width: 160px;
}
#game-info-area p { margin: 5px 0; font-size: 0.9em; }


#player-bottom-area {
    width: 70%;
    max-width: 600px;
    align-self: center; /* 底部玩家在牌桌内水平居中 */
    border: 2px solid var(--highlight-yellow);
}
#player-bottom-area .player-info { order: 3; } /* 信息在最下方 */
#player-bottom-area .played-cards-area { order: -1; } /* 出牌区在手牌上方 */


.player-info {
    font-weight: bold;
    margin-bottom: 5px;
    padding: 4px 8px;
    background-color: rgba(0,0,0,0.4);
    border-radius: 4px;
    font-size: 0.85em;
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    box-sizing: border-box;
}
.player-info .card-count { font-weight: normal; margin-left: 8px; }
.landlord-identity { color: var(--highlight-yellow); font-style: italic; margin-left: 8px; }


.hand {
    display: flex;
    flex-wrap: wrap; /* 允许换行，但对于对手可能不需要 */
    gap: 3px;
    min-height: calc(var(--card-height) + 10px);
    padding: 5px;
    border-radius: var(--card-border-radius);
    justify-content: center;
    align-items: flex-start;
    position: relative; /* 为了牌的叠放 */
}

/* 牌的叠放效果 */
.horizontal-hand .card {
    margin-right: calc(var(--card-width) * -0.75); /* 重叠3/4 */
}
.horizontal-hand .card:last-child { margin-right: 0; }

.vertical-hand {
    flex-direction: column; /* 垂直排列 */
    align-items: center;
    flex-wrap: nowrap; /* 垂直时通常不换行 */
    overflow: hidden; /* 隐藏超出部分的牌 */
}
.vertical-hand .card {
    margin-bottom: calc(var(--card-height) * -0.82); /* 垂直重叠更多 */
}
.vertical-hand .card:last-child { margin-bottom: 0; }

.card {
    width: var(--card-width);
    height: var(--card-height);
    background-color: white; /* 关键：确保牌有白色背景 */
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    border: 1px solid #666; /* 边框更明显 */
    border-radius: var(--card-border-radius);
    box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    cursor: pointer;
    transition: transform 0.1s ease-out, box-shadow 0.1s ease-out;
    image-rendering: crisp-edges; /* 尝试保持图片清晰 */
    position: relative; /* 确保 transform 生效 */
    z-index: 1; /* 基础层叠 */
}
.card:hover { z-index: 10; transform: scale(1.08); } /* 悬停时放大并置于顶层 */

.card.selected {
    transform: translateY(-10px) scale(1.1); /* 选中效果增强 */
    box-shadow: 0px 5px 10px rgba(0,0,0,0.4);
    border-color: var(--highlight-yellow);
    z-index: 5; /* 选中牌在普通牌之上 */
}

.played-cards-area {
    min-height: calc(var(--card-height) + 10px);
    width: 100%;
    max-width: 350px; /* 出的牌区域最大宽度 */
    margin: 5px auto;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 3px;
    padding: 5px;
    border-radius: var(--card-border-radius);
    /* background-color: rgba(0,0,0,0.1); */
}
.vertical-played { /* 左右玩家出牌区可以小一点 */
    flex-direction: column;
    max-width: calc(var(--card-width) * 1.5);
    min-height: auto;
}


.player-actions {
    margin-top: 8px;
    display: flex;
    justify-content: center;
    gap: 8px;
}

button {
    background-color: #555; /* 按钮颜色调整 */
    color: white;
    border: 1px solid #333;
    padding: 7px 14px;
    font-size: 13px;
    border-radius: var(--card-border-radius);
    cursor: pointer;
    transition: background-color 0.15s, transform 0.1s;
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}
button:hover:not(:disabled) {
    background-color: #777;
    transform: translateY(-1px);
}
button:active:not(:disabled) {
    transform: translateY(0px);
    box-shadow: inset 0 1px 1px rgba(0,0,0,0.2);
}
button:disabled {
    background-color: #999;
    border-color: #888;
    color: #ccc;
    cursor: not-allowed;
    box-shadow: none;
}

footer {
    background-color: #333;
    color: #ddd;
    text-align: center;
    padding: 0.6em 0;
    font-size: 0.8em;
    flex-shrink: 0; /* 防止footer被压缩 */
    z-index: 10;
}

#debug-info-area {
    position: fixed;
    bottom: calc(0.6em + 0.8em + 10px); /* 页脚高度 + 一些间距 */
    left: 10px;
    background: rgba(240, 240, 240, 0.9);
    padding: 6px 8px;
    border-radius: var(--card-border-radius);
    z-index: 20;
    font-size: 0.75em;
    max-width: 250px;
    box-shadow: 0 0 5px rgba(0,0,0,0.2);
    border: 1px solid #ccc;
}
#debug-info-area h4 { margin: 0 0 3px 0; color: #111; }
#debug-info-area p { margin: 0; color: #222; }
